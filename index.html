<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Income Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: system-ui, sans-serif;
  background: linear-gradient(135deg, #1f2933, #111827);
  color: white;
  padding: 20px;
}
.container {
  max-width: 700px;
  margin: auto;
  background: #111827;
  padding: 20px;
  border-radius: 14px;
}
input {
  width: 100%;
  padding: 8px;
  margin: 4px 0 10px;
  border-radius: 6px;
  border: none;
}
.progress {
  background: #1f2933;
  border-radius: 10px;
  overflow: hidden;
  height: 16px;
}
.bar {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #22c55e, #16a34a);
}
.small {
  font-size: 0.85em;
  opacity: 0.8;
}
.section {
  margin-top: 20px;
}
</style>
</head>

<body>
<div class="container">
<h2>ðŸ’¸ Daily Income Tracker</h2>

<label>Fortnightly Income</label>
<input id="income" type="number" step="0.01">

<div class="section">
<div class="small">Daily Income Progress</div>
<div class="progress"><div id="incomeBar" class="bar"></div></div>
<div id="incomeValue" class="small"></div>
</div>

<div class="section">
<h3>Categories (Fortnightly Spend)</h3>
<div id="categories"></div>
</div>

<div class="section">
<div class="small">Total Spend Today</div>
<div class="progress"><div id="totalSpendBar" class="bar"></div></div>
<div id="totalSpendValue" class="small"></div>
</div>

<div class="section">
<div class="small">Remaining Income Today</div>
<div class="progress"><div id="remainingBar" class="bar"></div></div>
<div id="remainingValue" class="small"></div>
</div>
</div>

<script>
const DAY_SECONDS = 86400;
const CATEGORY_COUNT = 5;

const incomeInput = document.getElementById("income");
const categoriesDiv = document.getElementById("categories");

const incomeBar = document.getElementById("incomeBar");
const incomeValue = document.getElementById("incomeValue");
const totalSpendBar = document.getElementById("totalSpendBar");
const totalSpendValue = document.getElementById("totalSpendValue");
const remainingBar = document.getElementById("remainingBar");
const remainingValue = document.getElementById("remainingValue");

let categories = [];

function secondsSinceMidnight() {
  const now = new Date();
  return now.getHours()*3600 + now.getMinutes()*60 + now.getSeconds();
}

/* ---------- URL + STORAGE ---------- */

function saveState() {
  const state = {
    income: incomeInput.value,
    categories: categories.map(c => ({
      name: c.name.value,
      amount: c.amount.value
    }))
  };

  localStorage.setItem("dailyIncomeTracker", JSON.stringify(state));

  const params = new URLSearchParams();
  if (state.income) params.set("income", state.income);
  state.categories.forEach((c, i) => {
    if (c.name) params.set(`c${i}n`, c.name);
    if (c.amount) params.set(`c${i}a`, c.amount);
  });

  history.replaceState(null, "", "?" + params.toString());
}

function loadState() {
  const params = new URLSearchParams(window.location.search);

  if (params.has("income")) {
    incomeInput.value = params.get("income");
  } else {
    const saved = JSON.parse(localStorage.getItem("dailyIncomeTracker"));
    if (saved?.income) incomeInput.value = saved.income;
  }

  categories.forEach((c, i) => {
    if (params.has(`c${i}n`)) c.name.value = params.get(`c${i}n`);
    if (params.has(`c${i}a`)) c.amount.value = params.g
